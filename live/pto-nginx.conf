  ## arthuredelstein.net

  server {
    listen 80;
    server_name arthuredelstein.net;
    return 301 https://$host$request_uri;
  }

  server {
    listen 443 ssl http2 default_server;
    ssl_certificate /etc/letsencrypt/live/arthuredelstein.net/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/arthuredelstein.net/privkey.pem; # managed by Certbot
    server_name arthuredelstein.net;
    index index.html index.htm index.html.en;
    root /home/arthur/arthuredelstein.net/;
    add_header Strict-Transport-Security "max-age=31536000";

    location /test-pages/ {
      add_header "Cache-Control" "no-store";

      alias /home/arthur/arthuredelstein.net/browser-privacy/static/;
      default_type text/html;
    }

    location /browser-privacy-live/ {
      proxy_pass http://127.0.0.1:3333/;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; ## allows us to get client ip address
    }

    location /browser-privacy-params/ {
      proxy_pass http://127.0.0.1:3334/;
    }

    location /pto-hook/ {
      proxy_pass http://127.0.0.1:2999/;
    }
  }

  server {
    listen 4433 ssl http2;
    server_name results.privacytests.org;
    index index.html index.htm index.html.en;
    root /home/arthur/arthuredelstein.net/;
    location / {
      alias /home/arthur/arthuredelstein.net/browser-privacy/static/alt2/;
    }
    ssl_certificate /etc/letsencrypt/live/results.privacytests.org/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/results.privacytests.org/privkey.pem; # managed by Certbot
    add_header "Strict-Transport-Security" "max-age=31536000";
    add_header "Access-Control-Allow-Origin" "*";
    add_header "Cache-Control" "no-store";
  }

  ## staging.privacytests.org

  server {
    listen 80;
    server_name staging.privacytests.org;
    return 301 https://$host$request_uri;
  }

  server {
    listen 443 ssl http2;
    ssl_certificate /etc/letsencrypt/live/staging.privacytests.org/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/staging.privacytests.org/privkey.pem; # managed by Certbot
    server_name staging.privacytests.org;
    index index.html index.htm index.html.en;
    root /home/arthur/arthuredelstein.net/browser-privacy/static/;
    add_header Strict-Transport-Security "max-age=31536000";
  }

  ## hsts.arthuredelstein.net

  server {
    listen 80;
    server_name hsts.arthuredelstein.net;
    root /home/arthur/arthuredelstein.net/browser-privacy/static/;
    add_header Cache-Control "max-age=0";
  }

  server {
    listen 443 ssl http2;
    server_name hsts.arthuredelstein.net;
    location / {
      proxy_pass http://127.0.0.1:3333/;
    }
    ssl_certificate /etc/letsencrypt/live/hsts.arthuredelstein.net/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/hsts.arthuredelstein.net/privkey.pem; # managed by Certbot
  }

  ## h3.arthuredelstein.net (Alt-Svc HTTP/2 to HTTP/3)

  server {
    listen 4434 ssl http2;
    ssl_certificate /etc/letsencrypt/live/h3.arthuredelstein.net/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/h3.arthuredelstein.net/privkey.pem; # managed by Certbot
    server_name h3.arthuredelstein.net;
    index index.html index.htm index.html.en;
    root /home/arthur/arthuredelstein.net/browser-privacy/static/h2/;
    default_type text/plain;
    location /connection_id {
      add_header "alt-svc" "h3=\":4434\"; ma=86400, h3-32=\":4434\"; ma=86400, h3-29=\":4434\"; ma=86400";
      add_header "Strict-Transport-Security" "max-age=31536000";
      add_header "Access-Control-Allow-Origin" "*";
      add_header "Cache-Control" "no-store";
    }
  }

  ## altsvc.arthuredelstein.net (Alt-Svc HTTP/2 to HTTP/3)

  server {
    listen 4433 ssl http2;
    ssl_certificate /etc/letsencrypt/live/altsvc.arthuredelstein.net/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/altsvc.arthuredelstein.net/privkey.pem; # managed by Certbot
    server_name altsvc.arthuredelstein.net;
    index index.html index.htm index.html.en;
    root /home/arthur/arthuredelstein.net/browser-privacy/static/h2/;
    default_type text/plain;
    location /set {
      add_header "alt-svc" "h3=\":4433\"; ma=86400, h3-32=\":4433\"; ma=86400, h3-29=\":4433\"; ma=86400";
      add_header "Strict-Transport-Security" "max-age=31536000";
      add_header "Access-Control-Allow-Origin" "*";
      add_header "Cache-Control" "no-store";
    }
    location /protocol {
      add_header "Strict-Transport-Security" "max-age=31536000";
      add_header "Access-Control-Allow-Origin" "*";
      add_header "Cache-Control" "no-store";
    }
    location /clear {
      add_header "Alt-Svc" "clear";
      add_header "Strict-Transport-Security" "max-age=31536000";
      add_header "Access-Control-Allow-Origin" "*";
      add_header "Cache-Control" "no-store";
    }
  }

  ## results.privacytests.org

  server {
    listen 80;
    server_name results.privacytests.org;
    return 301 https://$host$request_uri;
  }

  server {
    listen 443 ssl;
    server_name results.privacytests.org;
    ssl_certificate /etc/letsencrypt/live/results.privacytests.org/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/results.privacytests.org/privkey.pem; # managed by Certbot
    add_header Strict-Transport-Security "max-age=31536000";
    location /ws {
      proxy_pass http://127.0.0.1:3336/ws;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection "Upgrade";
      proxy_set_header Host $host;
    }

    location / {
      proxy_pass http://127.0.0.1:3335/;
    }

##    location /post {
##      proxy_pass http://127.0.0.1:3335/post;
##    }
##    location /results {
##      proxy_pass http://127.0.0.1:3335/results;
##    }
##    location /me {
##      proxy_pass http://127.0.0.1:3335/me;
##    }
##    location /step {
##      proxy_pass http://127.0.0.1:3335/me;
##    }
  }

  ## test-pages.privacytests.org

  server {
    listen 80;
    server_name test-pages.privacytests.org;
    return 301 https://$host$request_uri;
  }

  server {
    listen 443 ssl;
    server_name test-pages.privacytests.org;
    ssl_certificate /etc/letsencrypt/live/test-pages.privacytests.org/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/test-pages.privacytests.org/privkey.pem; # managed by Certbot
    add_header Strict-Transport-Security "max-age=31536000";

    location / {
       add_header "Cache-Control" "no-store";
       alias /home/arthur/arthuredelstein.net/browser-privacy/static/;
       default_type text/html;
    }
  }

  ## insecure.arthuredelstein.net

  server {
    listen 80;
    server_name insecure.arthuredelstein.net;
    location / {
      alias /home/arthur/arthuredelstein.net/browser-privacy/static/;
      default_type text/html;
    }
    location /content/ {
      alias /home/arthur/arthuredelstein.net/browser-privacy/live/;
    }
  }

  ## upgradable.arthuredelstein.net

  server {
    listen 80;
    server_name upgradable.arthuredelstein.net;
    location / {
      alias /home/arthur/arthuredelstein.net/browser-privacy/static/;
      default_type text/html;
    }
    location /content/ {
      alias /home/arthur/arthuredelstein.net/browser-privacy/live/;
    }
  }

  server {
    listen 443 ssl http2;
    server_name upgradable.arthuredelstein.net;
    ssl_certificate /etc/letsencrypt/live/upgradable.arthuredelstein.net/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/upgradable.arthuredelstein.net/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
    ssl on;
    location / {
      alias /home/arthur/arthuredelstein.net/browser-privacy/static/;
      default_type text/html;
    }
    location /content/ {
      alias /home/arthur/arthuredelstein.net/browser-privacy/live/;
    }
  }

  ## h1.arthuredelstein.net

  server {
    listen 443 ssl;
    ssl_certificate /etc/letsencrypt/live/h1.arthuredelstein.net/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/h1.arthuredelstein.net/privkey.pem; # managed by Certbot
    server_name h1.arthuredelstein.net;
    index index.html index.htm index.html.en;
    root /home/arthur/arthuredelstein.net/;
    add_header Strict-Transport-Security "max-age=31536000";

    location /browser-privacy-live/ {
      proxy_pass http://127.0.0.1:3333/;
    }

    location /browser-privacy-params/ {
      proxy_pass http://127.0.0.1:3334/;
    }
  }
