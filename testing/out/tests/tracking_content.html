<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf8"/>
    <link rel="shortcut icon" href="#">
  </head>
  <body>
    <script src="./post_data.js"></script>
    <script>
     const tests = [
       {
         name: "Google Tag Manager",
         url: "https://www.googletagmanager.com/gtm.js?id=GTM-NX4SMZL"
       },
       {
         name: "DoubleClick (Google)",
         url: "https://securepubads.g.doubleclick.net/tag/js/gpt.js"
       },
       {
         name: "Google Analytics",
         url: "https://google-analytics.com/ga.js"
       },
       {
         name: "Facebook Pixel",
         url: "https://www.facebook.com/tr?id=123"
       },
       {
         name: "Amazon adsystem",
         url: "https://aax.amazon-adsystem.com/e/ir?t=&l=&o="
       },
       {
         name: "Google Syndication",
         url: "https://tpc.googlesyndication.com/safeframe/1-0-35/html/container.html"
       },
       {
         name: "Scorecard Research Beacon",
         url: "https://sb.scorecardresearch.com/b?c1=2"
       },
       {
         name: "New Relic",
         url: "https://js-agent.newrelic.com/nr-1212.min.js"
       },
       {
         name: "Criteo",
         url: "https://csm.da.us.criteo.net/iev",
       },
       {
         name: "Adobe",
         url: "https://munchkin.marketo.net/munchkin.js"
       },
       {
         name: "Yandex Metrika",
         url: "https://mc.yandex.ru/metrika/tag.js"
       },
       {
         name: "AppNext",
         url: "https://ib.adnxs.com/bounce"
       },
       {
         name: "Google Ad Services",
         url: "https://www.googleadservices.com/pagead/conversion.js"
       },
       {
         name: "Twitter Ads",
         url: "https://static.ads-twitter.com/uwt.js"
       },
       {
         name: "Bing Ads",
         url: "https://bat.bing.com/bat.js"
       },
       {
         name: "Taboola",
         url: "https://trc-events.taboola.com/"
       },
       {
         name: "Yandex Ads",
         url: "https://yandex.ru/ads/system/header-bidding.js"
       },
       {
         name: "Quantcast",
         url: "https://pixel.quantserve.com/pixel"
       },
       {
         name: "Chartbeat",
         url: "https://pdev.chartbeat.net/ping?h=x&p=x&r=&b=",
       },
       {
         name: "Index Exchange",
         url: "https://js-sec.indexww.com/ht/p/182254-63191772774302.js"
       },
     ];
     const testUrl = async (url) => {
       let passed;
       try {
         const response = await fetch(url, {mode:"no-cors", cache:"no-store"});
         passed = false;
         console.log(response);
       } catch (err) {
         passed = true;
       }
       return passed;
     };
     const runTest = async () => {
       let results = {};
       for (const {name, url} of tests) {
         const passed = await testUrl(url);
         const description = `Tests whether the browser blocks the page from loading the tracker at ${url}`;
         results[name] = { url, passed, description };
       }
       console.log(results);
       await postDataAndCarryOn(results, "trackers");
     };
     runTest();
    </script>
  </body>
</html>
